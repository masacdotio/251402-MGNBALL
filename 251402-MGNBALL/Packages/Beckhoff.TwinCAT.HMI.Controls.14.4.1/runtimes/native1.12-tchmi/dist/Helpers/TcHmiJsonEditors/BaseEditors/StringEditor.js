import{TextboxBasedEditor}from"./TextboxBasedEditor.js";import{Editor}from"./Editor.js";export class StringEditor extends TextboxBasedEditor{constructor(element,editorInfo,factory){super(element,editorInfo,factory),this.__processEditorInfo()}static validate(editorInfo,value){return 0===StringEditor.checkForErrors(editorInfo,value,!0).length}static checkForErrors(editorInfo,value,returnEarly=!1){if("string"!=typeof value)return[{error:Editor.Error.NOT_A_STRING,parameters:[value]}];if(0===editorInfo.restrictions.length)return[];const restrictionErrors=[];for(const restriction of editorInfo.restrictions){const errors=[];if(restrictionErrors.push(errors),!(void 0!==restriction.minLength&&value.length<restriction.minLength&&(errors.push({error:Editor.Error.STRING_TOO_SHORT,parameters:[value,restriction.minLength,value.length]}),returnEarly))&&!(void 0!==restriction.maxLength&&value.length>restriction.maxLength&&(errors.push({error:Editor.Error.STRING_TOO_LONG,parameters:[value,restriction.maxLength,value.length]}),returnEarly))&&(!restriction.patterns||restriction.patterns.every(pattern=>pattern.test(value))||(errors.push({error:Editor.Error.STRING_DOES_NOT_MATCH,parameters:[value,restriction.patterns]}),!returnEarly))){if(restriction.format){let regex,error;switch(restriction.format){case"date-time":regex=/^\d{4}-(?:0\d|1[0-2])-(?:[0-2]\d|3[01])[Tt\s](?:[01]\d|2[0-3]):[0-5]\d:(?:[0-5]\d|60)(?:.\d+)?(?:[Zz]|[+-](?:[01]\d|2[0-3]):[0-5]\d)$/,error=Editor.Error.STRING_NOT_DATE_TIME;break;case"timespan":regex=/^P(?=.{2,})(?:\d+Y|\d+[.,]\d+Y$)?(?:\d+M|\d+[.,]\d+M$)?(?:\d+W|\d+[.,]\d+W$)?(?:\d+D|\d+[.,]\d+D$)?(?:T(?:\d+H|\d+[.,]\d+H$)?(?:\d+M|\d+[.,]\d+M$)?(?:\d+S|\d+[.,]\d+S$)?)?$/,error=Editor.Error.STRING_NOT_TIMESPAN;break;case"email":regex=/^(?:[^@\s"]+|".+")@(?:[^@.\s]+\.)+[^@.\s]+$/,error=Editor.Error.STRING_NOT_EMAIL;break;case"hostname":regex=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,error=Editor.Error.STRING_NOT_HOSTNAME;break;case"ipv4":regex=/^(?:(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)$/,error=Editor.Error.STRING_NOT_IPV4;break;case"ipv6":regex=/^(?:[0-9A-F]{1,4}:){7}[0-9A-F]{1,4}$|^(?:[0-9A-F]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)$|^(?=.*::)(?!.*(::).*\1.*)(?!.*:::.*)(?:(?:::)?(?:[0-9A-F]{1,4}::?){0,6}(?:[0-9A-F]{1,4}|::?)|(?:::)?(?:[0-9A-F]{1,4}::?){0,5}(?:(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[0-1]?\d?\d))$/i,error=Editor.Error.STRING_NOT_IPV6;break;case"uri":regex=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,error=Editor.Error.STRING_NOT_URI;break;default:regex=/[\s\S]*/,error=Editor.Error.ERROR}if(!regex.test(value)&&(errors.push({error,parameters:[value]}),returnEarly))continue}if(0===errors.length)return[]}}return 1===restrictionErrors.length?restrictionErrors[0]:[{error:Editor.Error.FAILS_ALL_RESTRICTIONS,parameters:[value],underlying:restrictionErrors.map(errors=>({error:Editor.Error.FAILS_THIS_RESTRICTION,underlying:errors}))}]}__processEditorInfo(){this.__updateValidationStatus()}setValue(value){this.__textbox.setText(value)}getRawValue(){return this.__textbox.getText()??""}}TcHmi.Controls.Helpers??={},TcHmi.Controls.Helpers.StringEditor=StringEditor;