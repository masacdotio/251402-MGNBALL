var __runInitializers=this&&this.__runInitializers||function(thisArg,initializers,value){for(var useValue=arguments.length>2,i=0;i<initializers.length;i++)value=useValue?initializers[i].call(thisArg,value):initializers[i].call(thisArg);return useValue?value:void 0},__esDecorate=this&&this.__esDecorate||function(ctor,descriptorIn,decorators,contextIn,initializers,extraInitializers){function accept(f){if(void 0!==f&&"function"!=typeof f)throw new TypeError("Function expected");return f}for(var _,kind=contextIn.kind,key="getter"===kind?"get":"setter"===kind?"set":"value",target=!descriptorIn&&ctor?contextIn.static?ctor:ctor.prototype:null,descriptor=descriptorIn||(target?Object.getOwnPropertyDescriptor(target,contextIn.name):{}),done=!1,i=decorators.length-1;i>=0;i--){var context={};for(var p in contextIn)context[p]="access"===p?{}:contextIn[p];for(var p in contextIn.access)context.access[p]=contextIn.access[p];context.addInitializer=function(f){if(done)throw new TypeError("Cannot add initializers after decoration has completed");extraInitializers.push(accept(f||null))};var result=(0,decorators[i])("accessor"===kind?{get:descriptor.get,set:descriptor.set}:descriptor[key],context);if("accessor"===kind){if(void 0===result)continue;if(null===result||"object"!=typeof result)throw new TypeError("Object expected");(_=accept(result.get))&&(descriptor.get=_),(_=accept(result.set))&&(descriptor.set=_),(_=accept(result.init))&&initializers.unshift(_)}else(_=accept(result))&&("field"===kind?initializers.unshift(_):descriptor[key]=_)}target&&Object.defineProperty(target,contextIn.name,descriptor),done=!0};import{Callback}from"Beckhoff.TwinCAT.HMI.Framework/index.esm.js";let Popup=(()=>{var _a,_b,_c,_d,_e,_f,_g,_h;let ___handleResize_decorators,___onCloseClick_decorators,___onPopupMouseDown_decorators,___onDocumentMouseUp_decorators,___onDocumentMouseMove_decorators,___onPopupTouchStart_decorators,___onDocumentTouchEndOrCancel_decorators,___onDocumentTouchMove_decorators,_instanceExtraInitializers=[];return class Popup{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;___handleResize_decorators=[(_a=TcHmi).CallbackMethod.bind(_a)],___onCloseClick_decorators=[(_b=TcHmi).CallbackMethod.bind(_b)],___onPopupMouseDown_decorators=[(_c=TcHmi).CallbackMethod.bind(_c)],___onDocumentMouseUp_decorators=[(_d=TcHmi).CallbackMethod.bind(_d)],___onDocumentMouseMove_decorators=[(_e=TcHmi).CallbackMethod.bind(_e)],___onPopupTouchStart_decorators=[(_f=TcHmi).CallbackMethod.bind(_f)],___onDocumentTouchEndOrCancel_decorators=[(_g=TcHmi).CallbackMethod.bind(_g)],___onDocumentTouchMove_decorators=[(_h=TcHmi).CallbackMethod.bind(_h)],__esDecorate(this,null,___handleResize_decorators,{kind:"method",name:"__handleResize",static:!1,private:!1,access:{has:obj=>"__handleResize"in obj,get:obj=>obj.__handleResize},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onCloseClick_decorators,{kind:"method",name:"__onCloseClick",static:!1,private:!1,access:{has:obj=>"__onCloseClick"in obj,get:obj=>obj.__onCloseClick},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onPopupMouseDown_decorators,{kind:"method",name:"__onPopupMouseDown",static:!1,private:!1,access:{has:obj=>"__onPopupMouseDown"in obj,get:obj=>obj.__onPopupMouseDown},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onDocumentMouseUp_decorators,{kind:"method",name:"__onDocumentMouseUp",static:!1,private:!1,access:{has:obj=>"__onDocumentMouseUp"in obj,get:obj=>obj.__onDocumentMouseUp},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onDocumentMouseMove_decorators,{kind:"method",name:"__onDocumentMouseMove",static:!1,private:!1,access:{has:obj=>"__onDocumentMouseMove"in obj,get:obj=>obj.__onDocumentMouseMove},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onPopupTouchStart_decorators,{kind:"method",name:"__onPopupTouchStart",static:!1,private:!1,access:{has:obj=>"__onPopupTouchStart"in obj,get:obj=>obj.__onPopupTouchStart},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onDocumentTouchEndOrCancel_decorators,{kind:"method",name:"__onDocumentTouchEndOrCancel",static:!1,private:!1,access:{has:obj=>"__onDocumentTouchEndOrCancel"in obj,get:obj=>obj.__onDocumentTouchEndOrCancel},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onDocumentTouchMove_decorators,{kind:"method",name:"__onDocumentTouchMove",static:!1,private:!1,access:{has:obj=>"__onDocumentTouchMove"in obj,get:obj=>obj.__onDocumentTouchMove},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}__parentControl=__runInitializers(this,_instanceExtraInitializers);static#tchmiFQN="TcHmi.Controls.Helpers."+this.name;__name;__element;__elementHeaderContainer;__elementHeader;__elementClose;__elementContent;__elementFooter;__childControls=[];__destroyers=[];__destroyOnHide=[];__prompt=null;__isShowing=!1;__onShowManager=new Callback.Collection;onShow=this.__onShowManager.getManipulators();__onHideManager=new Callback.Collection;onHide=this.__onHideManager.getManipulators();__onBoundsChangeManager=new Callback.Collection;onBoundsChange=this.__onBoundsChangeManager.getManipulators();__backgroundAction={close:!0};__closeButton={show:!1};__backgroundMode=Popup.BackgroundMode.Dimmed;__positioningMode=Popup.PositioningMode.Centered;__bounds=null;__movable=!1;__justAbove;__className="TcHmi_Controls_Helpers_Popup";__localizationSymbols=new Map;static __passiveEventOptions={passive:!0,capture:!1};__documentMouseMoveDestroyer=null;__documentMouseUpDestroyer=null;__documentTouchMoveDestroyer=null;__documentTouchEndDestroyer=null;__documentTouchCancelDestroyer=null;__touchLock=!1;__touchLockTimeoutId=0;__activeTouches=new Map;__movingInfo={moving:!1,startLeftOffset:0,startTopOffset:0,minLeft:0,minTop:0,maxLeft:0,maxTop:0};__activePointerInteraction=!1;__animationFrameId=0;__storage;__storageSettings;__resizeObserver;constructor(__parentControl){this.__parentControl=__parentControl,this.__name=`${this.constructor.name}-${tchmi_create_guid()}`,this.__parentControl&&(this.__name=`${this.__parentControl.getId()}.${this.__name}`);const controlClass=this.__parentControl?.getType().replace(/\./g,"_");this.__element=document.createElement("div"),this.__element.classList.add(this.__className,`${this.__className}-${this.constructor.name}`),controlClass&&this.__element.classList.add(`${controlClass}-popup`),this.__elementHeaderContainer=document.createElement("div"),this.__elementHeaderContainer.classList.add(`${this.__className}-header-container`),this.__elementHeader=document.createElement("h1"),this.__elementHeaderContainer.appendChild(this.__elementHeader),this.__elementClose=document.createElement("a"),this.__element.appendChild(this.__elementHeaderContainer),this.__elementContent=document.createElement("div"),this.__elementContent.classList.add(`${this.__className}-content`),this.__element.appendChild(this.__elementContent),this.__elementFooter=document.createElement("div"),this.__elementFooter.classList.add(`${this.__className}-footer`),this.__element.appendChild(this.__elementFooter),this.__parentControl&&this.__destroyers.push(TcHmi.EventProvider.register(this.__parentControl.getId()+".onDestroyed",()=>{this.destroy()})),this.__destroyers.push(TcHmi.EventProvider.registerDomEvent(this.__elementClose,"click",this.__onCloseClick,Popup.__passiveEventOptions),TcHmi.EventProvider.registerDomEvent(this.__element,"mousedown",this.__onPopupMouseDown,Popup.__passiveEventOptions),TcHmi.EventProvider.registerDomEvent(this.__element,"touchstart",this.__onPopupTouchStart,Popup.__passiveEventOptions)),this.__resizeObserver=new ResizeObserver(this.__handleResize)}__handleResize(){if(!this.__isShowing)return;const boundsElement=this.__element.getBoundingClientRect(),minLeft=50-boundsElement.width,maxLeft=window.innerWidth-50,maxTop=window.innerHeight-50;if(this.__bounds){let update=!1;const newBounds=tchmi_clone_object(this.__bounds);boundsElement.top<0?(update=!0,newBounds.top=0):boundsElement.top>maxTop&&(update=!0,newBounds.top=maxTop),boundsElement.left<minLeft?(update=!0,newBounds.left=minLeft):boundsElement.left>maxLeft&&(update=!0,newBounds.left=maxLeft),update&&this.setBounds(newBounds)}}show(){if(this.__isShowing)return;this.__positioningMode===Popup.PositioningMode.Centered&&this.__movable&&TcHmi.Log.errorEx(`[Source=ControlHelpers, Module=${Popup.#tchmiFQN}${this.__parentControl?`, Id=${this.__parentControl.getId()}`:""}] Invalid popup configuration. PositionMode=Centered and Movable=true is not useful.`),this.__resizeObserver.observe(this.__element),this.__destroyOnHide.push(TcHmi.EventProvider.registerDomEvent(window,"resize",this.__handleResize,{passive:!0})),this.__isShowing=!0;const options={removeCb:data=>{data.canceled&&this.__backgroundAction.close&&this.__performPromptAction(this.__backgroundAction),this.__isShowing=!1},centerHorizontal:this.__positioningMode===Popup.PositioningMode.Centered,centerVertical:this.__positioningMode===Popup.PositioningMode.Centered,dimBackground:this.__backgroundMode===Popup.BackgroundMode.Dimmed,closeOnBackground:this.__backgroundMode===Popup.BackgroundMode.Dimmed&&this.__backgroundAction.close,modal:this.__backgroundMode===Popup.BackgroundMode.Dimmed,justAbove:this.__justAbove};this.__parentControl?TcHmi.TopMostLayer.add(this.__parentControl,this.__element,options):TcHmi.TopMostLayer.addEx(this.__element,options),this.__onShowManager.trigger()}hide(){if(this.__isShowing){this.__isShowing=!1,this.__parentControl?TcHmi.TopMostLayer.remove(this.__parentControl,this.__element):TcHmi.TopMostLayer.removeEx(this.__element),this.__resizeObserver.unobserve(this.__element);for(const destroy of this.__destroyOnHide)destroy();this.__destroyOnHide=[],this.__onHideManager.trigger()}}prompt(){return this.__prompt?.error(new Error("Popup was prompted again without the previous prompt having been resolved.")),this.show(),new Promise((resolve,reject)=>{this.__prompt={answer:value=>{resolve(value),this.__prompt=null,this.hide()},error:value=>{reject(value),this.__prompt=null,this.hide()}}})}abort(action){this.hide(),action&&this.__performPromptAction(action),this.__prompt?.error(new Error("Popup was aborted, but no action to answer the prompt was specified."))}destroy(force=!1){this.hide();for(const destroy of this.__destroyers)destroy();this.__destroyers=[];for(const control of this.__childControls)force&&this.__parentControl&&this.__parentControl.__removeChild(control),control.destroy();this.__childControls=[];for(const entry of this.__localizationSymbols.values())entry.destroyWatch(),entry.symbol.destroy();this.__localizationSymbols.clear(),this.__documentMouseMoveDestroyer?.(),this.__documentMouseMoveDestroyer=null,this.__documentMouseUpDestroyer?.(),this.__documentMouseUpDestroyer=null,this.__documentTouchMoveDestroyer?.(),this.__documentTouchMoveDestroyer=null,this.__documentTouchEndDestroyer?.(),this.__documentTouchEndDestroyer=null,this.__documentTouchCancelDestroyer?.(),this.__documentTouchCancelDestroyer=null,this.__resizeObserver.disconnect()}isShowing(){return this.__isShowing}hasActivePrompt(){return null!==this.__prompt}getElement(){return this.__element}resetBounds(){this.__storage?.delete("bounds"),this.setBounds(null)}setBackgroundAction(action){this.__backgroundAction=action,this.__isShowing&&TcHmi.TopMostLayer.addEx(this.__element,{allowMultipleCall:!0,dimBackground:this.__backgroundMode===Popup.BackgroundMode.Dimmed,closeOnBackground:this.__backgroundMode===Popup.BackgroundMode.Dimmed&&this.__backgroundAction.close})}setBackgroundMode(mode){this.__backgroundMode=mode,this.__isShowing&&TcHmi.TopMostLayer.addEx(this.__element,{allowMultipleCall:!0,dimBackground:this.__backgroundMode===Popup.BackgroundMode.Dimmed,closeOnBackground:this.__backgroundMode===Popup.BackgroundMode.Dimmed&&this.__backgroundAction.close})}setPositioningMode(mode){this.__positioningMode=mode,this.__processBounds(this.__bounds),this.__isShowing&&TcHmi.TopMostLayer.addEx(this.__element,{allowMultipleCall:!0,centerHorizontal:this.__positioningMode===Popup.PositioningMode.Centered,centerVertical:this.__positioningMode===Popup.PositioningMode.Centered,modal:this.__positioningMode!==Popup.PositioningMode.Floating})}setBounds(bounds){this.__bounds=bounds,this.__processBounds(this.__bounds),this.__onBoundsChangeManager.trigger({bounds:this.__bounds})}__processBounds(bounds){bounds&&("number"==typeof bounds.width?this.__element.style.width=bounds.width+(bounds.widthUnit??"px"):this.__element.style.width="","number"==typeof bounds.height?this.__element.style.height=bounds.height+(bounds.heightUnit??"px"):this.__element.style.height="",this.__positioningMode===Popup.PositioningMode.Floating&&("number"==typeof bounds.left?this.__element.style.left=bounds.left+(bounds.leftUnit??"px"):this.__element.style.left="","number"==typeof bounds.top?this.__element.style.top=bounds.top+(bounds.topUnit??"px"):this.__element.style.top="","number"==typeof bounds.right?this.__element.style.right=bounds.right+(bounds.rightUnit??"px"):this.__element.style.right="","number"==typeof bounds.bottom?this.__element.style.bottom=bounds.bottom+(bounds.bottomUnit??"px"):this.__element.style.bottom=""))}setMovable(movable){this.__movable=movable,this.__movable?this.__element.style.touchAction="pinch-zoom":this.__element.style.touchAction=""}setStorageSettings(settings){if(this.__storage=new TcHmi.LocalStorage(settings.name,{bounds:tchmi_clone_object(this.__bounds)}),this.__storageSettings=settings,this.__storageSettings.restoreBounds){const storedBounds=this.__storage.get("bounds");storedBounds&&this.setBounds(storedBounds)}}setCloseButton(buttonOrShow){const button="boolean"==typeof buttonOrShow?{show:buttonOrShow}:buttonOrShow;button.show?this.__elementHeaderContainer.appendChild(this.__elementClose):this.__elementClose.remove(),this.__closeButton=button}getCloseButton(){return this.__closeButton}setJustAbove(reference,conflictResolution){if(reference){if(this.__justAbove?.reference===reference&&this.__justAbove.conflictResolution===conflictResolution)return;this.__justAbove={reference,conflictResolution}}else{if(!this.__justAbove)return;this.__justAbove=void 0}if(this.__isShowing){const options={allowMultipleCall:!0,justAbove:this.__justAbove};this.__parentControl?TcHmi.TopMostLayer.add(this.__parentControl,this.__element,options):TcHmi.TopMostLayer.addEx(this.__element,options)}}hasActiveUserInteraction(){return this.__activePointerInteraction||this.__element.contains(document.activeElement)}__onCloseClick(_event){this.__closeButton.show&&this.__performPromptAction(this.__closeButton),this.hide()}__onPopupMouseDown(event){if(!this.__touchLock&&this.__isShowing&&(this.__activePointerInteraction=!0,this.__documentMouseUpDestroyer=TcHmi.EventProvider.registerDomEvent(document,"mouseup",this.__onDocumentMouseUp,{...Popup.__passiveEventOptions,once:!0}),event.target!==this.__elementClose&&(this.__parentControl?TcHmi.TopMostLayer.add(this.__parentControl,this.__element,{allowMultipleCall:!0}):TcHmi.TopMostLayer.addEx(this.__element,{allowMultipleCall:!0}),this.__elementHeaderContainer.contains(event.target)&&this.__movable))){this.__documentMouseMoveDestroyer?.(),this.__documentMouseMoveDestroyer=TcHmi.EventProvider.registerDomEvent(document,"mousemove",this.__onDocumentMouseMove,Popup.__passiveEventOptions);const boundsElement=this.__element.getBoundingClientRect();this.__movingInfo.startLeftOffset=event.clientX-boundsElement.x,this.__movingInfo.startTopOffset=event.clientY-boundsElement.y,this.__movingInfo.minLeft=50-boundsElement.width,this.__movingInfo.maxLeft=window.innerWidth-50,this.__movingInfo.maxTop=window.innerHeight-50,this.__movingInfo.moving=!0}}__onDocumentMouseUp(_event){this.__touchLock||(this.__activePointerInteraction=!1,this.__documentMouseMoveDestroyer?.(),this.__documentMouseMoveDestroyer=null,this.__movingInfo.moving&&(this.__movingInfo.moving=!1,this.__movingInfo.startLeftOffset=0,this.__movingInfo.startTopOffset=0,this.__bounds&&this.__movable&&(this.__storage?.set("bounds",this.__bounds),this.__onBoundsChangeManager.trigger({bounds:this.__bounds}))))}__onDocumentMouseMove(event){if(0===event.buttons)return this.__movingInfo.moving=!1,this.__movingInfo.startLeftOffset=0,this.__movingInfo.startTopOffset=0,this.__touchLock=!1,this.__documentMouseMoveDestroyer?.(),void(this.__documentMouseMoveDestroyer=null);if(this.__touchLock)return;if(!this.__movable)return;if(!this.__movingInfo.moving)return;let left=event.clientX-this.__movingInfo.startLeftOffset;left<this.__movingInfo.minLeft?left=this.__movingInfo.minLeft:left>this.__movingInfo.maxLeft&&(left=this.__movingInfo.maxLeft);let top=event.clientY-this.__movingInfo.startTopOffset;top<this.__movingInfo.minTop?top=this.__movingInfo.minTop:top>this.__movingInfo.maxTop&&(top=this.__movingInfo.maxTop),this.__bounds||(this.__bounds={}),this.__bounds.left=left,this.__bounds.leftUnit="px",this.__bounds.top=top,this.__bounds.topUnit="px",this.__animationFrameId||(this.__animationFrameId=window.requestAnimationFrame(()=>this.__updatePosition()))}__onPopupTouchStart(event){if(this.__isShowing)if(this.__activePointerInteraction=!0,this.__documentTouchEndDestroyer?.(),this.__documentTouchEndDestroyer=TcHmi.EventProvider.registerDomEvent(document,"touchend",this.__onDocumentTouchEndOrCancel,Popup.__passiveEventOptions),this.__documentTouchCancelDestroyer?.(),this.__documentTouchCancelDestroyer=TcHmi.EventProvider.registerDomEvent(document,"touchcancel",this.__onDocumentTouchEndOrCancel,Popup.__passiveEventOptions),event.target!==this.__elementClose)if(this.__parentControl?TcHmi.TopMostLayer.add(this.__parentControl,this.__element,{allowMultipleCall:!0}):TcHmi.TopMostLayer.addEx(this.__element,{allowMultipleCall:!0}),this.__elementHeaderContainer.contains(event.target)){if(this.__movable){const boundsElement=this.__element.getBoundingClientRect();this.__movingInfo.moving||(this.__documentTouchMoveDestroyer?.(),this.__documentTouchMoveDestroyer=TcHmi.EventProvider.registerDomEvent(document,"touchmove",this.__onDocumentTouchMove,Popup.__passiveEventOptions),this.__movingInfo.startLeftOffset=event.changedTouches[0].clientX-boundsElement.x,this.__movingInfo.startTopOffset=event.changedTouches[0].clientY-boundsElement.y,this.__movingInfo.minLeft=50-boundsElement.width,this.__movingInfo.maxLeft=window.innerWidth-50,this.__movingInfo.maxTop=window.innerHeight-50,this.__movingInfo.moving=!0);for(const touch of event.changedTouches)this.__activeTouches.set(touch.identifier,{useForDragging:!0,offsetLeft:touch.clientX-boundsElement.x,offsetTop:touch.clientY-boundsElement.y})}else for(const touch of event.changedTouches)this.__activeTouches.set(touch.identifier,{useForDragging:!1});this.__touchLockTimeoutId&&(clearTimeout(this.__touchLockTimeoutId),this.__touchLockTimeoutId=0),this.__touchLock=!0}else for(const touch of event.changedTouches)this.__activeTouches.set(touch.identifier,{useForDragging:!1});else for(const touch of event.changedTouches)this.__activeTouches.set(touch.identifier,{useForDragging:!1})}__onDocumentTouchEndOrCancel(event){for(const touch of event.changedTouches)this.__activeTouches.delete(touch.identifier);0===this.__activeTouches.size&&(this.__documentTouchMoveDestroyer?.(),this.__documentTouchMoveDestroyer=null,this.__documentTouchEndDestroyer?.(),this.__documentTouchEndDestroyer=null,this.__documentTouchCancelDestroyer?.(),this.__documentTouchCancelDestroyer=null,this.__activePointerInteraction=!1);let draggingTouchFound=!1;for(const touchInfo of this.__activeTouches.values())if(touchInfo.useForDragging){this.__movingInfo.startLeftOffset=touchInfo.offsetLeft,this.__movingInfo.startTopOffset=touchInfo.offsetTop,draggingTouchFound=!0;break}draggingTouchFound||(this.__movingInfo.moving&&(this.__movingInfo.moving=!1,this.__movingInfo.startLeftOffset=0,this.__movingInfo.startTopOffset=0,this.__bounds&&this.__movable&&(this.__storage?.set("bounds",this.__bounds),this.__onBoundsChangeManager.trigger({bounds:this.__bounds}))),this.__touchLockTimeoutId&&(clearTimeout(this.__touchLockTimeoutId),this.__touchLockTimeoutId=0),this.__touchLockTimeoutId=setTimeout(()=>{this.__touchLock=!1},500))}__onDocumentTouchMove(event){if(!this.__movable)return;if(!this.__movingInfo.moving)return;if(1!==event.touches.length)return;if(!this.__activeTouches.get(event.changedTouches[0].identifier)?.useForDragging)return;let left=event.changedTouches[0].clientX-this.__movingInfo.startLeftOffset;left<this.__movingInfo.minLeft?left=this.__movingInfo.minLeft:left>this.__movingInfo.maxLeft&&(left=this.__movingInfo.maxLeft);let top=event.changedTouches[0].clientY-this.__movingInfo.startTopOffset;top<this.__movingInfo.minTop?top=this.__movingInfo.minTop:top>this.__movingInfo.maxTop&&(top=this.__movingInfo.maxTop),this.__bounds||(this.__bounds={}),this.__bounds.left=left,this.__bounds.leftUnit="px",this.__bounds.top=top,this.__bounds.topUnit="px",this.__animationFrameId||(this.__animationFrameId=window.requestAnimationFrame(()=>this.__updatePosition()))}__updatePosition(){this.__movingInfo.moving&&this.__bounds&&(this.__element.style.left=this.__bounds.left+(this.__bounds.leftUnit??"px"),this.__element.style.top=this.__bounds.top+(this.__bounds.topUnit??"px")),this.__animationFrameId=0}__applyTextToElement(name,text,elementOrSetter){if(null==text)return;const setter="object"==typeof elementOrSetter?text=>{elementOrSetter.textContent=text}:elementOrSetter;"object"==typeof text||TcHmi.Symbol.isSymbolExpression(text)?this.__watchLocalization(name,"string"==typeof text?{symbolExpression:text,formatValues:[]}:text,setter):(this.__unwatchLocalization(name),setter(text))}__applyTextToControl(name,text,control,property){if(null!=text)if("string"==typeof text)if(this.__unwatchLocalization(name),TcHmi.Symbol.isSymbolExpression(text))TcHmi.Binding.createEx2(text,property,control);else{const attribute=TcHmi.Controls.getDescription(control.getType())?.attributes?.find(attr=>attr.propertyName===property);attribute?.propertySetterName&&attribute.propertySetterName in control?control[attribute.propertySetterName](text):TcHmi.Log.errorEx(`[Source=ControlHelpers, Module=${Popup.#tchmiFQN}${this.__parentControl?`, Id=${this.__parentControl.getId()}`:""}] The attribute property name ${property} does not exist on control ${control.getId()} or is not writable.`)}else{const attribute=TcHmi.Controls.getDescription(control.getType())?.attributes?.find(attr=>attr.propertyName===property);let setter;if(!attribute?.propertySetterName||!(attribute.propertySetterName in control))return void TcHmi.Log.errorEx(`[Source=ControlHelpers, Module=${Popup.#tchmiFQN}${this.__parentControl?`, Id=${this.__parentControl.getId()}`:""}] The attribute property name ${property} does not exist on control ${control.getId()} or is not writable.`);setter=control[attribute.propertySetterName],TcHmi.Binding.removeEx2(null,property,control),this.__watchLocalization(name,text,text=>setter(text))}}__watchLocalization(name,localization,onChange){const existing=this.__localizationSymbols.get(name);existing?.destroyWatch(),existing?.symbol.destroy();const symbol=new TcHmi.Symbol(localization.symbolExpression),destroyWatch=symbol.watch(data=>{if(data.error!==TcHmi.Errors.NONE)return void TcHmi.Log.errorEx(`[Source=ControlHelpers, Module=${Popup.#tchmiFQN}${this.__parentControl?`, Id=${this.__parentControl.getId()}`:""}, TcHmi.SymbolExpression=${localization.symbolExpression}] `+TcHmi.Log.buildMessage(data.details));let text=data.value??"";localization.formatValues.length>0&&(text=tchmi_format_string(text,...localization.formatValues)),onChange(text)});this.__localizationSymbols.set(name,{symbol,destroyWatch})}__unwatchLocalization(name){const existing=this.__localizationSymbols.get(name);existing&&(existing.destroyWatch(),existing.symbol.destroy(),this.__localizationSymbols.delete(name))}}})();export{Popup};!function(Popup){let PositioningMode,BackgroundMode;!function(PositioningMode){PositioningMode[PositioningMode.Centered=1]="Centered",PositioningMode[PositioningMode.Floating=2]="Floating"}(PositioningMode=Popup.PositioningMode||(Popup.PositioningMode={})),function(BackgroundMode){BackgroundMode[BackgroundMode.None=1]="None",BackgroundMode[BackgroundMode.Dimmed=2]="Dimmed"}(BackgroundMode=Popup.BackgroundMode||(Popup.BackgroundMode={}))}(Popup||(Popup={})),TcHmi.Controls.Helpers??={},TcHmi.Controls.Helpers.Popup=Popup;