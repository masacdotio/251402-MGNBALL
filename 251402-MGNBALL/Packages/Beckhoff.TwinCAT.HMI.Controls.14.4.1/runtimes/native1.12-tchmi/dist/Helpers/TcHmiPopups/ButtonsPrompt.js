import{Callback}from"Beckhoff.TwinCAT.HMI.Framework/index.esm.js";import{Popup}from"./Popup.js";export class ButtonsPrompt extends Popup{__buttons=new Map;__onButtonPressedManager=new Callback.Collection;onButtonPressed=this.__onButtonPressedManager.getManipulators();__backgroundAction={close:!0};__closeButton={show:!1};constructor(buttons,parentControl){super(parentControl);for(const[name,buttonDef]of Object.entries(buttons)){const button=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",`${this.__name}.${name}`,buttonDef.attributes,this.__parentControl);if(!button)throw new Error("Could not create controls for ButtonsPrompt.");const buttonElement=button.getElement()[0];buttonElement.classList.add(name+"-button"),this.__elementFooter.appendChild(buttonElement),this.__destroyers.push(TcHmi.EventProvider.register(button.getId()+".onPressed",this.__createPressedHandler(buttonDef.value,name,!buttonDef.keepPopupOpen))),this.__buttons.set(name,{value:buttonDef.value,button}),this.__childControls.push(button)}}abort(action){super.abort(action)}__createPressedHandler(value,name,closePopup){return()=>{if(this.__parentControl){if(!this.__parentControl.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this.__parentControl,"operate"))return}closePopup&&(this.__prompt?this.__prompt.answer(value):this.hide()),this.__onButtonPressedManager.trigger(name,value)}}getButtons(){return this.__buttons}setBackgroundAction(action){super.setBackgroundAction(action)}setCloseButton(buttonOrShow){super.setCloseButton(buttonOrShow)}__performPromptAction(toPerform){if(this.__prompt)if("action"in toPerform&&void 0!==toPerform.action){const button=this.__buttons.get(toPerform.action);button&&this.__prompt.answer(button.value)}else"result"in toPerform&&this.__prompt.answer(toPerform.result)}setLocalizations(texts){this.setTexts(texts)}setTexts(texts){if(this.__applyTextToElement("headerText",texts.headerText,this.__elementHeader),texts.buttons)for(const[name,localization]of Object.entries(texts.buttons)){const button=this.__buttons.get(name)?.button;button&&localization&&(this.__applyTextToControl("buttonText"+name,localization.text,button,"Text"),this.__applyTextToControl("buttonTooltip"+name,localization.tooltip,button,"Tooltip"))}}}TcHmi.Controls.Helpers??={},TcHmi.Controls.Helpers.ButtonsPrompt=ButtonsPrompt;